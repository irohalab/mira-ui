<div class="bangumi-episodes section-card">
    <h4 class="section-header">各话列表</h4>
    <ul class="notice">
        <li><span class="ui green horizontal tiny label">&nbsp;</span> = 已下载</li>
        <li><span class="ui blue horizontal tiny label">&nbsp;</span> = 下载中</li>
    </ul>
    <div class="table-wrapper">
        <table class="ui celled padded table">
            <thead>
            <tr>
                <th>序号</th>
                <th style="width: 7rem;">预览图</th>
                <th>标题</th>
                <th>放送日期</th>
                <th>时长</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let episode of episodes"
                [ngClass]="{
                        downloaded: episode.status === 2 && !episode.removedMark,
                        downloading: episode.status === 1 && !episode.removedMark,
                        removed: episode.removedMark}">
                <td>{{episode.episodeNo}}</td>
                <td>
                    <div class="image-wrapper" *ngIf="episode.status !== 2 || !episode.thumbnailImage">
                        <div class="image-fallback">
                            <h4 class="ui icon film icon-holder">
                                <i class="film icon"></i>
                            </h4>
                        </div>
                    </div>
                    <ui-responsive-image
                        [src]="episode.thumbnailImage.url"
                        [size]="{
                                width: '6rem',
                                height: '3.375rem',
                                originalWidth: episode.thumbnailImage.width,
                                originalHeight: episode.thumbnailImage.height}"
                        display="block" *ngIf="episode.status === 2 && !!episode.thumbnailImage"
                        [background]="episode.thumbnailImage.dominantColor"></ui-responsive-image>
                </td>
                <td class="title">
                    <span class="key">日文:</span><span class="value">{{episode.name}}</span> <br>
                    <span class="key">中文:</span><span class="value">{{episode.nameCn}}</span>
                </td>
                <td>{{episode.airdate}}</td>
                <td>{{episode.duration}}</td>
                <td>
                    <a class="anchor-button" (click)="editEpisode(episode)" title="编辑"><i class="edit icon"></i></a>
                    <a class="anchor-button" (click)="editVideoFile(episode)" title="文件列表"><i class="server icon"></i></a>
                    <a class="anchor-button"
                       title="删除"
                       confirmDialog
                       dialogTitle="确定删除该话么"
                       dialogContent="删除该话将会同时删除与该话有关的torrent信息，文件，用户进度信息"
                       (onConfirm)="deleteEpisode(episode.id)"><i class="remove icon"></i></a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="float-action-buttons">
    <button class="ui circular icon primary button" (click)="editEpisode()" title="Add Episode" type="button">
        <i class="plus icon"></i>
    </button>
    <button class="ui circular icon orange button"
            confirmDialog
            dialogTitle="确定要同步剧集吗？"
            dialogContent="如果bgm.tv增加了新的剧集，会被自动添加，如果bgm修改了id或删除了剧集可能会出现删除的提示。所有已有剧集会被更新信息"
            (onConfirm)="syncEpisodes()" title="Sync Episodes" type="button">
        <i class="sync icon"></i>
    </button>
</div>